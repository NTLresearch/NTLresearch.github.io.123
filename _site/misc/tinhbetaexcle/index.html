<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Tinh beta bằng Excel</title>
    <meta name="description" content="Cách tiếp cận truyền thống để tính toán hệ số Beta là dựa vào phương trình hồi quy cho lợi nhuận của chỉ số thị trường và lợi nhuận của cổ phiếu. Thông thườn...">


    

    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet">
    <link rel="canonical" href="http://NTLresearch.github.io/misc/tinhbetaexcle">
    <link rel="alternate" type="application/rss+xml" title="NTL RESEARCH" href="http://NTLresearch.github.io/feed.xml" />

    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
       <script type="text/x-mathjax-config">
         MathJax.Hub.Config({
           tex2jax: {
             inlineMath: [ ['$','$'], ["\\(","\\)"] ],
             processEscapes: true
           }
         });
       </script>
       <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

</head>

</head>
<body>
    <header>
    <div class="container-fluid bg-light font-header">
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand" href="http://NTLresearch.github.io">
                <h3 class="display-5">NTL RESEARCH</h3>
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collaspe navbar-collapse" id="navbarNav">
                <ul class="navbar-nav bg-light" style="color:black">
                    <!-- <div class="navbar-nav"> -->
                    
                    
                    <li class="nav-item active">
                        <a class="nav-link text-dark" href="/about">
                            Về chúng tôi
                            <span class="sr-only">(current)</span>
                        </a>
                    </li>
                    
                    
                    
                    <li class="nav-item">
                        <a class="nav-link text-dark" href="/VI">
                            Đầu tư giá trị
                        </a>
                    </li>
                    
                    
                    
                    <li class="nav-item">
                        <a class="nav-link text-dark" href="/ToanTaiChinh">
                            Toán tài chính
                        </a>
                    </li>
                    
                    
                    
                    <li class="nav-item">
                        <a class="nav-link text-dark" href="/PM">
                            Lý thuyết portfolio
                        </a>
                    </li>
                    
                    
                    
                    <li class="nav-item">
                        <a class="nav-link text-dark" href="/Programming">
                            Programming
                        </a>
                    </li>
                    
                    
                    
                    <li class="nav-item">
                        <a class="nav-link text-dark" href="/Stats">
                            Statistics
                        </a>
                    </li>
                    
                    
                    
                    <li class="nav-item">
                        <a class="nav-link text-dark" href="/TR">
                            Track Record
                        </a>
                    </li>
                    
                    
                    
                    <li class="nav-item">
                        <a class="nav-link text-dark" href="/Misc">
                            Misc
                        </a>
                    </li>
                    
                    
                    
                    <li class="nav-item">
                        <a class="nav-link text-dark" href="/portfolio">
                            portfolio
                        </a>
                    </li>
                    
                    
                </ul>
            </div>

        </nav>
    </div>
</header>


    <div class="page-content">

        <div class="container-fluid text-center">
            <!-- 
            <img src="" height=600 align="middle" style="margin: 0 auto; display:block" alt="">
             -->

        </div>
        <br>
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-3 text-center bottom-three">

                    <div>
                        <img class="rounded-circle" src="/images/icon/bio-photo.jpg" width=100px style="padding: 5px; border: 1px solid #f2f3f3;" alt="">
                    </div>
                    <br>
                    <div class="container text-secondary">
                        <h4 class="display-5">
                            
                            <h3 class="display-5">Thanh Nguyen M</h3>
                            
                        </h4>
                    </div>
                </div>
                <div class="col-md-7">
                    <div class="container">
                        <header class="post-header">
                            <h1 class="post-title">Tinh beta bằng Excel</h1>
                            <p class="post-meta">Apr 28, 2016</p>
                        </header>
                        <div>
                            <img class="center-image" src="/images/Excel/excel1p.png" height=400px>
                        </div>
                        <br>
                        <article class="post-content font-body1">
                            <p>Cách tiếp cận truyền thống để tính toán hệ số Beta là dựa vào phương trình hồi quy cho lợi nhuận của chỉ số thị trường và lợi nhuận của cổ phiếu. Thông thường tỉ suất lợi nhuận được tính toán dựa trên số liệu về giá đã được điều chỉnh cho các khoản như chia tách hoặc chia cổ tức bằng cổ phiếu.</p>

<p>Tỉ suất lợi nhuận nên được tính toán theo tháng hoặc theo tuần (theo Investment Valuation - Damodaran). Hệ số Beta về mặt lý thuyết được tính như sau:</p>

<script type="math/tex; mode=display">\frac{covariance(r_s, r_m)}{variance(r_m)}</script>

<p>Covariance là hiệp phương sai giữa tỉ suất lợi nhuận của cổ phiếu và tỉ suất lợi nhuận của thị trường cần tính toán.
Variance trong công thức là phương sai của tỉ suất lợi nhuận của chỉ số thị trường.
Hệ số beta được giải thích như sau:</p>

<ul>
  <li>
    <p>Giả sử Beta của 1 cổ phiếu đo được là 1.3, theo lý thuyết, khi thị trường đạt tỉ suất lợi nhuận là 1% thì tỉ suất lợi nhuận của cổ phiếu có thể đạt được là 1.3 * 1% = 1.3%. Kết quả trên chỉ đúng khi lãi suất phi rủi ro gần hoặc tương đương 0%.</p>
  </li>
  <li>
    <p>Nếu chúng ta ước lượng thị trường có tỉ lệ lãi suất phi rủi ro là 7%, tỉ suất lợi nhuận kì vọng của thị trường chung là 10%. Vậy 1 cổ phiếu có beta bằng 1.3 sẽ có tỉ suất lợi nhuận kì vọng tương đương:</p>
  </li>
</ul>

<script type="math/tex; mode=display">E(r_s) = r_f + \beta \times (E(r_m) - r_f) = 7\% + 1.3\% \times (10\% - 7\%) = 10.9 \%</script>

<p>Lúc này tỉ suất lợi nhuận kì vọng của cổ phiếu được tính toán dựa trên hệ số beta là 10.9%, cao hơn 0.9% so với tỉ suất lợi nhuận kì vọng của thị trường chung.</p>

<ul>
  <li>
    <p>Beta cũng có thể âm hoặc dương. Beta dương tức là khi thị trường có tỉ suất lợi nhuận dương, cổ phiếu cho tỉ suất lợi nhuận dương, tức là vận động cùng với thị trường. Khi Beta âm, thị trường có thể có tỉ suất loại nhuận dương, nhưng lúc này tỉ suất lợi nhuận ở cổ phiếu có thể âm, vận động ngược chiều với thị trường.</p>
  </li>
  <li>
    <p>Khi chỉ số Beta bằng 0, tức là cổ phiếu không có mối tương quan với thị trường.</p>
  </li>
</ul>

<p>Đa số các trang web tài chính ở Việt Nam như CafeF hay Vietstock đều cung cấp hệ số Beta. Tuy nhiên với những ai muốn tính toán trực tiếp hệ số Beta, điều chỉnh các thông số có thể tính toán rất nhanh qua Excel bằng hàm Slope.
Đầu tiên bạn truy cập vào <a href="http://cophieu68.com">cophieu68</a>, download dữ liệu excel về giá đã được điều chỉnh hằng ngày.</p>

<p><img src="/images/Excel/excel1.png" alt="c1" /></p>

<p>Sau đó lấy dữ liệu từ 2 cột <DTYYYMMDD> và <Close> để tính toán Beta.</Close></DTYYYMMDD></p>

<p><img src="/images/Excel/excel2.png" alt="c2" /></p>

<p>Vấn đề ở đây là dữ liệu của cophieu68 được input cho Amibroker và Metastock Format nên ngày tháng sẽ viết liền như hình ở trên. Vì thế chúng ta chuyển đổi dữ liệu sang dạng chuẩn qua excel thông qua hàm Date như sau:</p>

<p><img src="/images/Excel/excel3.png" alt="c3" /></p>

<p>Dữ liệu trong Cophieu68 được sắp xếp theo thứ tự dữ liệu mới nhất được cập nhật ở trên, vì thế khi lọc xong data, chúng ta dùng bộ lọc Filter chỉnh từ oldest to newest để thuận tiện cho việc tính toán tỉ suất lợi nhuận. Sau đó copy Date, Close của VNindex và mã cổ phiếu cần tính toán ra 1 sheet riêng như hình bên dưới:</p>

<p><img src="/images/Excel/excel4.png" alt="c4" /></p>

<p>Tỉ suất lợi nhuận theo tháng sẽ được tính theo số liệu Close và ngày cuối cùng của tháng như công thức bên dưới:</p>

<p><img src="/images/Excel/excel5.png" alt="c5" /></p>

<p>Thông thường, chúng ta nên tính toán tỉ suất lợi nhuận tối thiểu trong 2 năm (24) tháng do yêu cầu của hồi quy thường phải có tối thiểu 25 quan sát. Sau khi đã có đủ số lượng quan sát của tí suất lợi nhuận, chúng ta dùng hàm Slope để tính toán ra Beta như hình dưới:</p>

<p><img src="/images/Excel/excel6.png" alt="c6" /></p>

<p>Do mã CAV chỉ có số liệu từ năm 2015 nên ở bài viết tôi chỉ tính toán trên 12 quan sát, số liệu sẽ không thật sự chính xác. Theo Damodaran, việc dùng tỉ suất lợi nhuận theo tuần hay theo tháng ảnh hưởng tương đối lớn đến việc tính toán beta. Ngoài ra có thể chọn chuỗi thời gian trong 2 năm tới 3 năm hoặc hơn. Tuy nhiên, chuỗi thời gian càng dài, bản chất rủi ro và hoạt động của doanh nghiệp thay đổi nên hệ số beta có khả năng không phản ánh đúng bản chất của cổ phiếu ở thời điểm tính toán.</p>

<p>Hàm Slope trong Beta cũng không cho xem xét hệ số R-squared (coefficient of determination) nên chúng ta khó có thể biết độ chính xác của hệ số Beta trong thực tế. Bài viết sau về OLS sẽ có cái nhìn chi tiết hơn về phương trình hồi quy dạng cơ bản trong excel.</p>

<p>Ngoài ra việc chọn chỉ số thị trường để tính toán beta cũng quan trọng. Giả sử cổ phiếu giao dịch trên sàn Upcom, bạn nên sử dụng chỉ số Upcom để tính toán thay vì VN-index hay HNX-index.</p>

                            <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
                        </article>
                    </div>
                </div>
            </div>
        </div>

    <footer class="site-footer">

    <div class="wrapper">

        <p class="rss-subscribe">subscribe <a href="/feed.xml">via RSS</a></p>

        <h2 class="footer-heading">NTL RESEARCH</h2>
        <p>© 2018. All rights reserved.</p>

        <div class="footer-col-wrapper">
            <div class="footer-col  footer-col-1">
                <ul class="contact-list">
                    <!-- <li>NTL RESEARCH</li> -->
                    <li><a href="mailto:NTLresearchgroup@gmail.com">NTLresearchgroup@gmail.com</a></li>
                </ul>
            </div>

            <div class="footer-col  footer-col-2">
                <ul class="social-media-list">
                    
                    <li>
                        <a href="https://github.com/NTLresearchgroup">
                            <span class="icon  icon--github">
                                <svg viewBox="0 0 16 16">
                                    <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                                </svg>
                            </span>

                            <span class="username">NTLresearchgroup</span>
                        </a>
                    </li>
                    

                    
                    <li>
                        <a href="https://twitter.com/D4xu0">
                            <span class="icon  icon--twitter">
                                <svg viewBox="0 0 16 16">
                                    <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                                    c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                                </svg>
                            </span>

                            <span class="username">D4xu0</span>
                        </a>
                    </li>
                    
                </ul>
            </div>

            <div class="footer-col  footer-col-3">
                <p class="text">Luôn có những rủi ro liên quan đến vấn đề đầu tư bao gồm cả việc mất toàn bộ vốn. Hiệu quả đầu tư trong quá khứ không đảm bảo cho kết quả trong tương lai. Nhà đầu tư nên xem xét cẩn thận mục tiêu đầu tư, ràng buộc, rủi ro và những chi phí liên quan.
</p>
            </div>
        </div>

    </div>

</footer>

    



<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


    </body>
</html>
